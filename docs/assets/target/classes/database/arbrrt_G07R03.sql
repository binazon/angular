USE RefReport; 
delete from TJ_REPORTING_GROUP_TO_OFFER_OPTION where OFFER_OPTION_FK in (select PK from T_OFFER_OPTION where ALIAS like 'DOD_%');
delete a from T_ENTITY_ATTRIBUTE as a left outer join (select MAX(PK) as PK, NAME, REPORTING_ENTITY_FK from T_ENTITY_ATTRIBUTE where NAME='physicalCallLimiter' group by NAME, REPORTING_ENTITY_FK ) as t1 on a.PK = t1.PK where a.NAME='physicalCallLimiter' and t1.PK is null;
delete a from T_ENTITY_ATTRIBUTE as a left outer join (select MAX(PK) as PK, NAME, REPORTING_ENTITY_FK from T_ENTITY_ATTRIBUTE where NAME='areaCallLimiter' group by NAME, REPORTING_ENTITY_FK ) as t1 on a.PK = t1.PK where a.NAME='areaCallLimiter' and t1.PK is null;
delete from T_ENTITY_ATTRIBUTE where NAME='T1T7';
delete from T_ENTITY_ATTRIBUTE where NAME='CClabel';
delete l from T_ENTITY_LINK as l left outer join (select MAX(PK) as PK, REPORTING_ENTITY_DEST_FK from T_ENTITY_LINK where ROLE='CALLLIMITER' and TYPE='CALLLIMITER' group by REPORTING_ENTITY_DEST_FK ) as t1 on l.PK = t1.PK where l.ROLE='CALLLIMITER' and l.TYPE='CALLLIMITER' and t1.PK is null;
delete l from T_ENTITY_LINK as l left outer join (select MAX(l1.PK) as PK, l1.REPORTING_ENTITY_DEST_FK from T_ENTITY_LINK l1 join T_REPORTING_ENTITY e1 on e1.PK=l1.REPORTING_ENTITY_DEST_FK and e1.ENTITY_TYPE='TERMINAL'  where l1.ROLE='SITE' and l1.TYPE='SITE' group by l1.REPORTING_ENTITY_DEST_FK) as t1 on l.PK = t1.PK join T_REPORTING_ENTITY e on e.PK=l.REPORTING_ENTITY_DEST_FK and e.ENTITY_TYPE='TERMINAL' where l.ROLE='SITE' and l.TYPE='SITE' and t1.PK is null;
delete l from T_ENTITY_LINK as l left outer join (select MAX(l1.PK) as PK, l1.REPORTING_ENTITY_DEST_FK from T_ENTITY_LINK l1 join T_REPORTING_ENTITY e1 on e1.PK=l1.REPORTING_ENTITY_DEST_FK and e1.ENTITY_TYPE='SITE'  where l1.ROLE='SITE' and l1.TYPE='SITE' group by l1.REPORTING_ENTITY_DEST_FK) as t1 on l.PK = t1.PK join T_REPORTING_ENTITY e on e.PK=l.REPORTING_ENTITY_DEST_FK and e.ENTITY_TYPE='SITE' where l.ROLE='SITE' and l.TYPE='SITE' and t1.PK is null;
delete l from T_ENTITY_LINK as l left outer join (select MAX(l1.PK) as PK, l1.REPORTING_ENTITY_DEST_FK from T_ENTITY_LINK l1 join T_REPORTING_ENTITY e1 on e1.PK=l1.REPORTING_ENTITY_DEST_FK and e1.ENTITY_TYPE='CITY'  where l1.ROLE='SITE' and l1.TYPE='SITE' group by l1.REPORTING_ENTITY_DEST_FK) as t1 on l.PK = t1.PK join T_REPORTING_ENTITY e on e.PK=l.REPORTING_ENTITY_DEST_FK and e.ENTITY_TYPE='CITY' where l.ROLE='SITE' and l.TYPE='SITE' and t1.PK is null;
insert into T_GROUP_ATTRIBUTE (NAME,VALUE,REPORTING_GROUP_FK) values ('DISPLAY_ALL_COS_BB','true', (select pk from T_REPORTING_GROUP where reporting_group_ref='162'));
delete from T_ENTITY_LINK where type = 'MEASURE' and role = 'ORIGINFDN' and reporting_entity_dest_fk in (select pk from T_REPORTING_ENTITY where entity_type='LOGICALCONNECTION');
delete from T_ENTITY_LINK where type = 'MEASURE' and role = 'ENDFDN' and reporting_entity_dest_fk in (select pk from T_REPORTING_ENTITY where entity_type='LOGICALCONNECTION');
